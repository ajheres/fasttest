syntax = "proto3";
package mtm;
import "google/protobuf/timestamp.proto";
import "google/protobuf/any.proto";

message Envelope 
{
	// Time when the message was generated
	google.protobuf.Timestamp time = 1;

	// System id of the key. Combine with 'key_server_id' and 'key_seq_no' to identify the key instance used to encrypt the content in this message
	uint32 key_id = 2;
	
	// System id of the key Server that generated the 
	uint32 key_server_id = 3;
	
	// The unique sequence number of the key generated by server 'key_server_id'
	uint32 key_seq_no = 4;
	
	// System id of source (Base station or external source) from configuration
	uint32 source_id = 5;

	// The 32-bit checksum of the 'blob'. Used to verify that the decryption of 'blob' was successful.
	uint32 checksum = 6;

	oneof content
	{
		// Set when sent without encryption, that is when key_id, key_server_id and key_seq_no are set to zero.
		google.protobuf.Any message = 7;

		// Set when sent encrypted. Use the key instance identified by key_id, key_server_id and key_seq_no to encrypt the content.
		// The content is an encrypted serialized protobuf message specified by the multicast endpoint
		// Decrypt the binary content and parse the decrypted data as a protobuf message specified by the multicast endpoint
		bytes blob = 8;
	}
}